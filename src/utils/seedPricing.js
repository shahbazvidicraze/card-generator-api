const PriceConfiguration = require('../models/PriceConfiguration.model');

// The full pricing JSON data you provided.
const pricingData = [
    {
        "cardType": "Standard 300gsm Bridge",
        "size": "57x88mm",
        "pricing": [
            { "deckRange": "20-50", "cards": { "30-50": 13.96, "51-75": 14.89, "76-100": 15.81, "101-120": 16.56 }, "box": 3.01 },
            { "deckRange": "51-100", "cards": { "30-50": 6.34, "51-75": 7.27, "76-100": 8.20, "101-120": 8.94 }, "box": 1.76 },
            { "deckRange": "101-250", "cards": { "30-50": 4.81, "51-75": 5.75, "76-100": 6.67, "101-120": 7.42 }, "box": 1.28 },
            { "deckRange": "251-500", "cards": { "30-50": 3.48, "51-75": 4.42, "76-100": 5.34, "101-120": 6.08 }, "box": 1.04 },
            { "deckRange": "501-1000", "cards": { "30-50": 3.01, "51-75": 3.94, "76-100": 4.86, "101-120": 5.61 }, "box": 0.91 },
            { "deckRange": "1001-2500", "cards": { "30-50": 2.77, "51-75": 3.70, "76-100": 4.63, "101-120": 5.37 }, "box": 0.88 },
            { "deckRange": "2500+", "cards": { "30-50": 2.63, "51-75": 3.56, "76-100": 4.48, "101-120": 4.22 }, "box": 0.87 }
        ]
    },
    {
        "cardType": "Linen 350gsm Bridge",
        "size": "57x88mm",
        "pricing": [
            { "deckRange": "20-50", "cards": { "30-50": 48.16, "51-75": 51.37, "76-100": 54.54, "101-120": 57.13 }, "box": 10.38 },
            { "deckRange": "51-100", "cards": { "30-50": 21.87, "51-75": 25.08, "76-100": 28.29, "101-120": 30.84 }, "box": 6.07 },
            { "deckRange": "101-250", "cards": { "30-50": 16.59, "51-75": 19.84, "76-100": 23.01, "101-120": 25.60 }, "box": 4.42 },
            { "deckRange": "251-500", "cards": { "30-50": 12.01, "51-75": 15.25, "76-100": 18.42, "101-120": 20.98 }, "box": 3.59 },
            { "deckRange": "501-1000", "cards": { "30-50": 10.38, "51-75": 13.59, "76-100": 16.77, "101-120": 19.35 }, "box": 3.14 },
            { "deckRange": "1001-2500", "cards": { "30-50": 9.56, "51-75": 12.77, "76-100": 15.97, "101-120": 18.53 }, "box": 3.04 },
            { "deckRange": "2500+", "cards": { "30-50": 9.07, "51-75": 12.28, "76-100": 15.46, "101-120": 14.56 }, "box": 3.00 }
        ]
    },
    {
        "cardType": "Standard 300gsm Poker",
        "size": "63x88mm",
        "pricing": [
            { "deckRange": "20-50", "cards": { "30-50": 16.29, "51-75": 17.37, "76-100": 18.45, "101-120": 19.32 }, "box": 3.01 },
            { "deckRange": "51-100", "cards": { "30-50": 7.40, "51-75": 8.48, "76-100": 9.57, "101-120": 10.43 }, "box": 1.76 },
            { "deckRange": "101-250", "cards": { "30-50": 5.61, "51-75": 6.71, "76-100": 7.78, "101-120": 8.66 }, "box": 1.28 },
            { "deckRange": "251-500", "cards": { "30-50": 4.06, "51-75": 5.16, "76-100": 6.23, "101-120": 7.09 }, "box": 1.04 },
            { "deckRange": "501-1000", "cards": { "30-50": 3.51, "51-75": 4.60, "76-100": 5.67, "101-120": 6.55 }, "box": 0.91 },
            { "deckRange": "1001-2500", "cards": { "30-50": 3.23, "51-75": 4.32, "76-100": 5.40, "101-120": 6.27 }, "box": 0.88 },
            { "deckRange": "2500+", "cards": { "30-50": 3.07, "51-75": 4.15, "76-100": 5.23, "101-120": 4.92 }, "box": 0.87 }
        ]
    },
    {
        "cardType": "Linen 350gsm Poker",
        "size": "63x88mm",
        "pricing": [
            { "deckRange": "20-50", "cards": { "30-50": 56.19, "51-75": 59.93, "76-100": 63.64, "101-120": 66.65 }, "box": 10.38 },
            { "deckRange": "51-100", "cards": { "30-50": 25.52, "51-75": 29.26, "76-100": 33.01, "101-120": 35.98 }, "box": 6.07 },
            { "deckRange": "101-250", "cards": { "30-50": 19.36, "51-75": 23.14, "76-100": 26.85, "101-120": 29.87 }, "box": 4.42 },
            { "deckRange": "251-500", "cards": { "30-50": 14.01, "51-75": 17.79, "76-100": 21.49, "101-120": 24.47 }, "box": 3.59 },
            { "deckRange": "501-1000", "cards": { "30-50": 12.12, "51-75": 15.86, "76-100": 19.56, "101-120": 22.58 }, "box": 3.14 },
            { "deckRange": "1001-2500", "cards": { "30-50": 11.15, "51-75": 14.89, "76-100": 18.64, "101-120": 21.61 }, "box": 3.04 },
            { "deckRange": "2500+", "cards": { "30-50": 10.59, "51-75": 14.33, "76-100": 18.03, "101-120": 16.99 }, "box": 3.00 }
        ]
    },
    {
        "cardType": "Standard 300gsm Tarot",
        "size": "70x120mm",
        "pricing": [
            { "deckRange": "20-50", "cards": { "30-50": 24.43, "51-75": 26.06, "76-100": 27.67, "101-120": 28.98 }, "box": 6.02 },
            { "deckRange": "51-100", "cards": { "30-50": 11.10, "51-75": 12.72, "76-100": 14.35, "101-120": 15.65 }, "box": 3.52 },
            { "deckRange": "101-250", "cards": { "30-50": 8.42, "51-75": 10.06, "76-100": 11.67, "101-120": 12.99 }, "box": 2.56 },
            { "deckRange": "251-500", "cards": { "30-50": 6.09, "51-75": 7.74, "76-100": 9.35, "101-120": 10.64 }, "box": 2.08 },
            { "deckRange": "501-1000", "cards": { "30-50": 5.27, "51-75": 6.90, "76-100": 8.51, "101-120": 9.82 }, "box": 1.82 },
            { "deckRange": "1001-2500", "cards": { "30-50": 4.85, "51-75": 6.48, "76-100": 8.10, "101-120": 9.40 }, "box": 1.78 },
            { "deckRange": "2500+", "cards": { "30-50": 4.60, "51-75": 6.23, "76-100": 7.84, "101-120": 7.39 }, "box": 1.74 }
        ]
    },
    {
        "cardType": "Linen 350gsm Tarot",
        "size": "70x120mm",
        "pricing": [
            { "deckRange": "20-50", "cards": { "30-50": 84.28, "51-75": 89.90, "76-100": 95.45, "101-120": 99.98 }, "box": 20.77 },
            { "deckRange": "51-100", "cards": { "30-50": 38.28, "51-75": 43.89, "76-100": 49.51, "101-120": 53.98 }, "box": 12.14 },
            { "deckRange": "101-250", "cards": { "30-50": 29.04, "51-75": 34.72, "76-100": 40.27, "101-120": 44.80 }, "box": 8.83 },
            { "deckRange": "251-500", "cards": { "30-50": 21.01, "51-75": 26.69, "76-100": 32.24, "101-120": 36.71 }, "box": 7.18 },
            { "deckRange": "501-1000", "cards": { "30-50": 18.17, "51-75": 23.79, "76-100": 29.34, "101-120": 33.87 }, "box": 6.28 },
            { "deckRange": "1001-2500", "cards": { "30-50": 16.72, "51-75": 22.34, "76-100": 27.95, "101-120": 32.42 }, "box": 6.14 },
            { "deckRange": "2500+", "cards": { "30-50": 15.88, "51-75": 21.49, "76-100": 27.05, "101-120": 25.48 }, "box": 6.00 }
        ]
    }
];

const seedPricing = async () => {
    try {
        console.log('Checking for default pricing configuration...');
        
        // Use findOneAndUpdate with upsert:true to either create the document or update it if it exists.
        // This makes the seeding process robust and safe to run on every server start.
        await PriceConfiguration.findOneAndUpdate(
            { configKey: 'DEFAULT_PRICING_TABLE' }, // Find the document with this key
            { pricingTable: pricingData },         // Set the pricingTable to our fresh data
            { upsert: true, new: true }              // Options: create if it doesn't exist, return the new doc
        );
        
        console.log('Default pricing configuration check complete. Database is seeded.');
    } catch (error) {
        console.error('Error seeding database with pricing configuration:', error);
    }
};

module.exports = seedPricing;